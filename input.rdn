macro-env xret return @(macro-env#FUNC);

declare: lul;

foo = f: xret {
  print("foo");
  if !lul then return "bar";
  print("far"); // never reached if lul is false
};

print(foo());
lul = true;
foo();

macro-env myEnv what {
  macro-env#ARG what = f(ms) wait(ms);
  macro-env#FUNC(macro-env#ARG what);
};

nasa = f: myEnv {
  what 2500;
  print("OK");
};

nasa();
